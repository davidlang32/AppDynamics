$processes = get-process | Where {$_.Name -match "^CSFalconService$|^BESClient$|^QualysAgent$|^splunkd$|^logger$|^FillDB$|^GatherDB$|^BESRootServer$|^BESWebReportsServer$|^BESPluginService$|^BESWebUI$|^BESRelay$|^BESPluginPortal$|^certsrv$|^K2HostServer$|^SourceCode.Configuration.Api$|^K2ServerEvent$|^Nanobot$|^apache2.conf$|^java$|^Services.msc$|^CSFalconService$|^falcon-sensor$|^BrokerAgent$|^BrokerService$|^CdfSvc$|^Citrix.ADIdentity$|^Citrix.Analytics$|^Citrix.AppLibrary$|^Citrix.Authentication.FederatedAuthenticationService$|^Citrix.Configuration$|^Citrix.ConfigurationLogging$|^Citrix.DelegatedAdmin$|^Citrix.DeliveryServices.ConfigurationReplicationService.ServiceHost$|^Citrix.DeliveryServices.CredentialWallet.ServiceHost$|^Citrix.DeliveryServices.DomainServices.ServiceHost$|^Citrix.DeliveryServices.PeerResolutionService.ServiceHost$|^Citrix.DeliveryServices.ServiceMonitor.ServiceHost$|^Citrix.DeliveryServices.SubscriptionsStore.ServiceHost$|^Citrix.EnvTest$|^Citrix.Host$|^Citrix.MachineCreation$|^Citrix.Monitor$|^Citrix.Orchestration$|^Citrix.Storefront$|^Citrix.Storefront.PrivilegedService$|^Citrix.Trust$|^ConfigSyncService$|^CpSvc$|^CseEngine$|^CtxCeipSvc$|^CtxLocalUserSrv$|^CtxLSPortSvc$|^CtxRdr$|^CtxSvcHost$|^encsvc$|^HighAvailabilityService$|^httpd$|^ImaAdvanceSrv64$|^lmadmin$|^SCService64$|^SemsService$|^TelemetryService$|^UWACacheService$|^WebSocketService$|^XaXdCloudProxy$|^asm_pmon_+ASM$|^ora_pmon_cdb12201$|^ora_pmon_cdb19300$|^tnslsnr$|^httpd$"}
foreach($process in $processes)
{
    $processName = $process.ProcessName
    write-host "name=Custom Metrics|ProcessMon|$processName,value=1"
}